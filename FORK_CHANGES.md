# FORK_CHANGES.md - 変更詳細と開発プロセス

このドキュメントは、オリジナルの `kblood/MCPComputerUse` からの変更点、およびその背景となった開発プロセスを詳細に記録したものです。

## 🤖 開発プロセス：AI と人間によるペアプログラミング
本プロジェクトのデバッグおよびリファクタリングは、**Google Antigravity (AI)** と **マスター (人間)** による「ペアプログラミング」によって行われました。

AIによる自動的な修正を嫌う開発者の懸念を考慮し、本プロジェクトでは以下の役割分担で誠実な開発を行っています。
- **マスター (人間)**: エラーの根本原因の特定（バッチファイルの分析、SDK警告の意味の解釈）、設計の方向性指示、最終的なコード品質の検証。
- **Antigravity (AI)**: 指示に基づくソースコードの一括修正、環境構築、ドキュメントの生成、自動検証テスト。

---

## 🗑️ 削除されたファイルリスト
解析の結果、本MCPサーバーの動作に不要、または特定の個人環境に依存しすぎていると判断された以下のファイルを削除しました。

| カテゴリ | ファイル名 | 理由 |
| :--- | :--- | :--- |
| **Skyrim 関連** | `README.txt`, `LAUNCH.bat`, `INSTALL.bat`, `CREATE_PACKAGE.bat` | 作者が Skyrim Mod 設定環境をベースに使用していた名残。 |
| **一時ファイル** | `test_err.log`, `tools/mcp-server.log` | 開発時の一時ログ。 |
| **解析ドキュメント** | `BLOG/` フォルダ, `IMPLEMENTATION_COMPLETE.md` 等 | 今回のフォーク作業用の中間生成物。 |

---

## 📝 改変されたソースコードと修正ルール

### 対象ファイルリスト
- `src/MCPComputerUse/Program.cs`
- `src/MCPComputerUse/Tools/MacroAndUtilityTools.cs`
- `src/MCPComputerUse/Tools/WindowTools.cs` (およびその他全ツール定義ファイル)
- `src/WindowsAutomation/Macros/MacroEngine.cs`
- `src/WindowsAutomation/WindowsAutomation.csproj`

### 修正の基本ルール
1. **公式 SDK への完全準拠**: 独自定義されていたメタデータ属性を、公式な `[McpServerTool]` に置き換える。
2. **命名規則の遵守**: クライアント側でのエラーを避けるため、ツール名からコロン (`:`) を除去し、`^[a-zA-Z0-9_-]+$` に適合させる。
3. **パス依存性の排除**: `C:\LLM\...` などのハードコードを修正し、プロジェクト相対または設定ファイル経由での制御に変更。

---

## 🛠️ 潜在的な問題の解決：サブクラスの衝突 (CS0436)

### 問題の背景
本ソフトウェアが公式 SDK リリース前のプレビュー版をベースにしていたため、作者が独自に定義した「空のスタブクラス」が、後に導入された公式 SDK の型と名前衝突（CS0436）を起こしていました。コンパイラが「古い空の定義」を優先して参照してしまい、メタデータの出力に失敗していました。

### 不要となったサブクラス（型）の整理内容
以下の衝突していた型定義を物理的に削除し、公式 SDK 側を参照するように修正しました。
- `McpServerToolTypeAttribute`
- `McpServerToolAttribute`
- `McpServerToolParameterAttribute`

**対処内容**: これらの独自定義ファイルを削除し、ソースコード全般で `ModelContextProtocol.Core` 名前空間の公式属性を使用するようにリファクタリングを完遂しました。
これにより、ビルド時の警告を完全に 0 にし、ツールの認識率 100% を達成しました。
